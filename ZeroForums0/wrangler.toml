# ZeroForums0 - Cloudflare Workers Configuration
# 
# Production-grade configuration for the ultra-secure encrypted platform
# 
# Developed By: Sherlock
# Telegram: @tx_5w
# Instagram: @j.86vb
# TikTok: @default_room105

name = "zeroforums0"
main = "backend/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Environment Configuration
[env.production]
name = "zeroforums0-prod"
route = "zeroforums0.pages.dev/*"
zone_id = ""

[env.development]
name = "zeroforums0-dev"
route = "dev.zeroforums0.pages.dev/*"
zone_id = ""

# KV Namespaces
[[kv_namespaces]]
binding = "FORUMS_KV"
id = "75ee7d913a7642219efe0a0ddfb08033"

[[kv_namespaces]]
binding = "AUTH_KV"
id = "c3b3af72c1524a499cc0fa8a46202b3c"

[[kv_namespaces]]
binding = "CHAT_KV"
id = "02103612b5af4f599f1c009d97bb77ff"

[[kv_namespaces]]
binding = "FORUM_KV"
id = "c442c97854e747c599a875bf20318905"

# Durable Objects
[[durable_objects]]
name = "ChatRoom"
class_name = "ChatRoom"

[[durable_objects]]
name = "ForumRoom"
class_name = "ForumRoom"

[[durable_objects]]
name = "UserSession"
class_name = "UserSession"

# R2 Buckets (for file storage)
[[r2_buckets]]
binding = "FILES_BUCKET"
bucket_name = "zeroforums0-files"

# Variables
[vars]
ENVIRONMENT = "production"
API_VERSION = "v1"
MAX_FILE_SIZE = 52428800  # 50MB
MAX_MESSAGE_LENGTH = 10000
SESSION_TIMEOUT = 86400000  # 24 hours in milliseconds
CAPTCHA_TIMEOUT = 300000    # 5 minutes in milliseconds
RATE_LIMIT_WINDOW = 60000   # 1 minute in milliseconds
RATE_LIMIT_MAX_REQUESTS = 100

# Build Configuration
[build]
command = "npm run build"
watch_dir = "frontend"
upload.format = "service-worker"

[build.upload]
format = "service-worker"

# Triggers
[triggers]
crons = ["0 0 * * *"]  # Daily cleanup at midnight UTC

# Pages Configuration
[pages_build_config]
build_command = "npm run build"
build_output_dir = "frontend"
compatibility_flags = ["nodejs_compat"]

# Security Headers
[http_headers]
"/*" = [
  { name = "X-Content-Type-Options", value = "nosniff" },
  { name = "X-Frame-Options", value = "DENY" },
  { name = "X-XSS-Protection", value = "1; mode=block" },
  { name = "Referrer-Policy", value = "strict-origin-when-cross-origin" },
  { name = "Content-Security-Policy", value = "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self';" },
  { name = "Strict-Transport-Security", value = "max-age=31536000; includeSubDomains; preload" },
  { name = "Permissions-Policy", value = "camera=(), microphone=(), geolocation=(), gyroscope=(), magnetometer=(), payment=(), usb=(), accelerometer=()" }
]

# Custom Domains
[[custom_domains]]
domain = "zeroforums0.com"
validation_records = [
  { name = "zeroforums0.com", type = "TXT", content = "your-verification-token" }
]

# Logpush
[logpush]
enabled = true
dataset = "http_requests"
logpull_options = "fields=ClientIP,ClientRequestHost,ClientRequestMethod,ClientRequestURI,EdgeEndTimestamp,EdgeResponseBytes,EdgeResponseStatus,EdgeStartTimestamp,RayID"

# Cache
[cache]
default_ttl = 3600
default_browser_ttl = 0

default_cache_key = "url"
